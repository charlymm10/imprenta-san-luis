<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Imprenta San Luis</title>
    <link rel="stylesheet" href="style.css">
    <script src="script.js" defer></script>
    <link rel="icon" type="image/x-icon" href="favicon.ico">
</head>
<body>
<header>
    <img src="logo imprenta.png" alt="Logo" class="logo">
    <h1>Imprenta San Luis</h1>
    <form class="search-form" id="searchForm" onsubmit="return buscarPedido(event);">
        <label for="pedidoId">ID de Pedido:</label>
        <input type="text" id="pedidoId" name="pedidoId" required pattern="^[0-9]+$" title="Solo se permiten números.">
        <button type="submit">Buscar</button>
    </form>
    <div id="resultadoBusqueda" class="resultado-busqueda">
        <p id="estadoPedido">Resultado: -</p>
    </div>
</header>
<main class="centered-content">
    <section id="productos">
        <h2>Productos</h2>
        <div class="gallery">
            <!-- Aquí se repiten los productos como en tu ejemplo anterior -->
            <!-- Sección de productos ya creada -->
        </div>
    </section>
</main>
<footer>
    <p>© 2024 Imprenta San Luis. Todos los derechos reservados.</p>
</footer>

<script>
// Función para buscar el pedido
async function buscarPedido(event) {
    event.preventDefault(); // Evita que el formulario se envíe de forma convencional

    const pedidoId = document.getElementById('pedidoId').value; // Obtiene el ID del pedido

    try {
        // Detecta si el sitio está usando HTTP o HTTPS
        const protocolo = window.location.protocol; // Devuelve "http:" o "https:"
        const dominio = window.location.hostname; // Obtiene el dominio actual

        // Genera la URL para la consulta
        const urlConsulta = `${protocolo}//imprentasanluis.atwebpages.com/consulta_pagina_web2.php?pedidoId=${pedidoId}`;

        const response = await fetch(urlConsulta);

        // Manejar errores de la red
        if (!response.ok) {
            throw new Error('Error en la red');
        }

        const data = await response.json(); // Convierte la respuesta a JSON

        // Actualiza el contenido del elemento con el estado del pedido
        const estadoPedidoElement = document.getElementById('estadoPedido');
        if (data.estado) {
            estadoPedidoElement.textContent = `Estado del Pedido: ${data.estado}`;
        } else {
            estadoPedidoElement.textContent = `Error: ${data.error}`;
        }
    } catch (error) {
        const estadoPedidoElement = document.getElementById('estadoPedido');
        estadoPedidoElement.textContent = `Error: ${error.message}`;
    }
}
</script>
</body>
</html>
